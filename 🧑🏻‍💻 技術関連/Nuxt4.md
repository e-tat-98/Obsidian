# 🚀 Nuxt 4の主な特徴と改善点

Nuxt 4の導入によって得られるメリット…

## 1. 圧倒的なパフォーマンス向上

- **Nitroエンジンの完全統合・最適化**: Nuxt 3から導入されたNitroエンジンが完全に統合され、アプリケーションのすべての側面を強化するコア機能として設計されました。
    
- **ビルドとCLIの高速化**: 開発中のホットモジュールリプレースメント（HMR）をサポートするViteがデフォルトで採用され、**CLIの速度も改善**し、開発環境の起動速度が向上しています。
    

## 2. 開発者体験（DX）の改善

- **TypeScript体験の向上**: アプリケーションのコードとサーバーサイドのコード（`server/`）を明確に分離することで、TypeScriptの型チェック体験が向上しました。
    
- **新しいディレクトリ構造**: 後方互換性はあるものの、クライアント側のコードをルートフォルダではなく、**`app/`フォルダ**に配置することが推奨されるなど、ディレクトリ構造の変更が入っています。
    
- **`shared/`フォルダの導入**: クライアントサイドとサーバーサイドの両方で使える関数や型定義を共有するための**`shared/`フォルダ**が導入されました。これにより、型安全性がさらに高まります。
    

## 3. 柔軟な機能とレンダリング

- **フルスタック開発の強化**: サーバーサイドコードを管理するための**`server/`ディレクトリ**が導入され、より強力なAPIルーティングシステムが提供されています。これにより、複雑なAPIも簡単に構築できます。
    
- **柔軟なレンダリング方式**: サーバーサイドレンダリング（SSR）、静的サイト生成（SSG）、クライアントサイドレンダリング（CSR）といった複数のレンダリング方式を柔軟に選択・組み合わせることが可能です。
    
- **自動インポート**: Vueのコンポーザブルやコンポーネントをインポートせずに使用できる自動インポート機能があり、開発効率が向上します。

# ⚡️Nuxt3 → Nuxt4 マイグレーションポイント

Nuxt 3からNuxt 4への移行は、主に**開発者体験（DX）の向上**と**パフォーマンス強化**が目的とされています。Nuxt 2から3への移行ほど大きな破壊的変更はありませんが、いくつかの重要な変更点があります。

## 🛠️ Nuxt 4 マイグレーションの主要ポイント

### 1. 構造とTypeScriptの変更（破壊的変更を含む）

|**分類**|**変更点**|**対応のポイント**|
|---|---|---|
|**ディレクトリ構造の変更**|アプリケーションコードの推奨配置先が、従来のルートフォルダから**`app/`フォルダ**へ変更されました。|**`app/`への移動**: `pages/`や`components/`などのファイルを`app/`内に移動することが推奨されますが、後方互換性はあるため、**移行はオプション**です。|
|**TypeScript体験の向上**|アプリケーション、サーバー、共有コード間でTypeScriptの設定が分離され、型チェック体験が向上しました。|**型定義の見直し**: 特に`server/`ディレクトリ内のコードや、新しく導入された**`shared/`フォルダ**を使ってクライアント・サーバー間で型やユーティリティを共有する構成に見直すと、TypeScriptの恩恵を最大限に受けられます。|
|**`useAsyncData`/`useFetch`の改善**|`useAsyncData`や`useFetch`が、キーが同じ場合**`ref`を共有する**ように動作が改善されました。|**キーの管理**: データフェッチのキー設定がより重要になります。意図しないデータ共有を防ぐため、キーの重複がないか確認しましょう。|

## 2. Nitroとモジュール（統合の強化）

|**分類**|**変更点**|**対応のポイント**|
|---|---|---|
|**Nitroエンジンの完全統合**|Nitroエンジンがコア機能としてアプリケーション全体を強化する設計になりました。|**`server/`ディレクトリの確認**: 既存のサーバーサイドコード（APIルートやサーバーミドルウェアなど）がNitroの恩恵を最大限に受けているか確認します。|
|**モジュールシステムの進化**|従来のNuxt.jsモジュールが廃止され、代わりに**Nitroモジュール**が導入されました。|**モジュールの移行**: 使用している外部モジュールがNuxt 4/Nitroモジュールに対応しているか確認し、必要であれば対応バージョンへのアップデートや、移行作業を行います。|

#### 3. パフォーマンスとツール

|**分類**|**変更点**|**対応のポイント**|
|---|---|---|
|**Viteのデフォルト採用**|デフォルトのビルドツールとしてViteが採用され、開発中のHMR（ホットモジュールリプレースメント）がサポートされています。|**ビルド設定の見直し**: 独自のカスタム設定（特にSCSSなど）がある場合、Viteビルダーでの動作に問題がないか確認します。|
|**CLIの高速化**|Nuxtのコマンドラインインターフェースの実行速度が改善されました。|**特になし**: 開発者体験が向上します。|

#### 4. 移行サポート

- **自動マイグレーションツールの提供**: Nuxt 4では、**`codemod`を使用した自動マイグレーションツールが用意されています。
    
- **対応のポイント**: `codemod`を一括実行するか、一部除外して個別に実行することで、手動での書き換え作業を最小限に抑えられます。まずはこのツールを活用するのがおすすめです！
